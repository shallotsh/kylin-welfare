version: "3.3"
# 注意，使用该脚本启动服务，需要先用`deploy_with_docker.sh`构建好启动所需的镜像 `kylin/welfare`
services:
  welfare_1:
    image: kylin/welfare:latest
    volumes:
      - wyf_attachment:/var/attachment
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro
    restart: always
    environment:
      WELFARE_VAR: echo
      TZ: Asia/Shanghai
    ports:
      - "8081:8080"
    entrypoint: java -server -XX:SurvivorRatio=8 -XX:NewRatio=4 -XX:MetaspaceSize=64m -XX:MaxMetaspaceSize=64m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:+PrintGCApplicationConcurrentTime -Xloggc:/var/attachment/logs/welfare-1.gc.log -jar /app/kylin-welfare.jar
  welfare_2:
    image: kylin/welfare:latest
    volumes:
      - wyf_attachment:/var/attachment
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro
    restart: always
    environment:
      WELFARE_VAR: echo
      TZ: Asia/Shanghai
    ports:
      - "8082:8080"
    entrypoint: java -server -XX:SurvivorRatio=8 -XX:NewRatio=4 -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=128m -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:+PrintGCApplicationConcurrentTime -Xloggc:/var/attachment/logs/welfare-2.gc.log -jar /app/kylin-welfare.jar
volumes:
  wyf_attachment: {}